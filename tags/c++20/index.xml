<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>C++20 on liubang's blog</title><link>https://iliubang.cn/tags/c++20/</link><description>Recent content in C++20 on liubang's blog</description><generator>Hugo</generator><language>zh-cn</language><copyright>Copyright © 2019-2025 LiuBang. All Rights Reserved.</copyright><lastBuildDate>Tue, 15 Mar 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://iliubang.cn/tags/c++20/index.xml" rel="self" type="application/rss+xml"/><item><title>c++20:Designated Initializers</title><link>https://iliubang.cn/posts/cpp/2022-03-15-c++20-designated_initializers/</link><pubDate>Tue, 15 Mar 2022 00:00:00 +0000</pubDate><guid>https://iliubang.cn/posts/cpp/2022-03-15-c++20-designated_initializers/</guid><description><![CDATA[<p>对于熟悉 c99 的人来说，Designated Initializers 并不算是什么新鲜事物，然而 c++直到 c++20 才正式支持这一特性。
虽然在 c++20 之前，像 GCC 这样的编译器通过扩展的形式已经对该特性做了支持，但是随着 c++20 将其纳入新标准，这一特性将在所有编译器中得到支持。</p>

<h2 id="基本用法" data-numberify>基本用法<a class="anchor ms-1" href="#基本用法"></a></h2>
<p>Designated Initialization 是聚合初始化(Aggregate Initialization)的一种形式。
在 c++20 中，聚合类型(Aggregate types)是指：</p>
<ul>
<li>数组类型</li>
<li>具备如下特性的 class 类型：</li>
<li>
<ul>
<li>has no private or protected direct non-static data members</li>
</ul>
</li>
<li>
<ul>
<li>has no user-declared or inherited constructors</li>
</ul>
</li>
<li>
<ul>
<li>has no virtual, private, or protected base classes</li>
</ul>
</li>
<li>
<ul>
<li>has no virtual member functions</li>
</ul>
</li>
</ul>
<p>c++20 中的 Designated Initializers 的用法跟 c99 非常相似：</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-cpp" data-lang="cpp"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f" id="hl-0-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-1">1</a></span><span><span style="color:#c678dd">struct</span> <span style="color:#e5c07b">Points</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f" id="hl-0-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-2">2</a></span><span>{
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f" id="hl-0-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-3">3</a></span><span>    <span style="color:#e5c07b">double</span> <span style="color:#e06c75">x</span>{<span style="color:#d19a66">0.0</span>};
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f" id="hl-0-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-4">4</a></span><span>    <span style="color:#e5c07b">double</span> <span style="color:#e06c75">y</span>{<span style="color:#d19a66">0.0</span>};
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f" id="hl-0-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-5">5</a></span><span>};
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f" id="hl-0-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-6">6</a></span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f" id="hl-0-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-7">7</a></span><span><span style="color:#c678dd">const</span> <span style="color:#e06c75">Points</span> <span style="color:#e06c75">p</span>{.<span style="color:#e06c75">x</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">1.1</span>, .<span style="color:#e06c75">y</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">2.2</span>};
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f" id="hl-0-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-8">8</a></span><span><span style="color:#c678dd">const</span> <span style="color:#e06c75">Points</span> <span style="color:#e06c75">o</span>{.<span style="color:#e06c75">x</span>{<span style="color:#d19a66">1.1</span>}, .<span style="color:#e06c75">y</span>{<span style="color:#d19a66">2.2</span>}};
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#55595f" id="hl-0-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-9">9</a></span><span><span style="color:#c678dd">const</span> <span style="color:#e06c75">Points</span> <span style="color:#e06c75">x</span>{.<span style="color:#e06c75">x</span> <span style="color:#56b6c2">=</span> <span style="color:#d19a66">1.1</span>, .<span style="color:#e06c75">y</span>{<span style="color:#d19a66">2.2</span>}};
</span></span></code></pre></div>
<h2 id="优点" data-numberify>优点<a class="anchor ms-1" href="#优点"></a></h2>
<p>使用 Designated Initializers 最大的好处就是能够提升代码的可读性。</p>]]></description></item></channel></rss>